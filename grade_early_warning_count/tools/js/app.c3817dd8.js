(function(t){function e(e){for(var o,a,n=e[0],r=e[1],i=e[2],d=0,h=[];d<n.length;d++)a=n[d],Object.prototype.hasOwnProperty.call(l,a)&&l[a]&&h.push(l[a][0]),l[a]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);u&&u(e);while(h.length)h.shift()();return s.push.apply(s,i||[]),c()}function c(){for(var t,e=0;e<s.length;e++){for(var c=s[e],o=!0,n=1;n<c.length;n++){var r=c[n];0!==l[r]&&(o=!1)}o&&(s.splice(e--,1),t=a(a.s=c[0]))}return t}var o={},l={app:0},s=[];function a(e){if(o[e])return o[e].exports;var c=o[e]={i:e,l:!1,exports:{}};return t[e].call(c.exports,c,c.exports,a),c.l=!0,c.exports}a.m=t,a.c=o,a.d=function(t,e,c){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:c})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(c,o,function(e){return t[e]}.bind(null,o));return c},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/grade_early_warning_count/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],r=n.push.bind(n);n.push=e,n=n.slice();for(var i=0;i<n.length;i++)e(n[i]);var u=r;s.push([0,"chunk-vendors"]),c()})({0:function(t,e,c){t.exports=c("56d7")},1:function(t,e){},2:function(t,e){},5189:function(t,e,c){},"56d7":function(t,e,c){"use strict";c.r(e);c("e260"),c("e6cf"),c("cca6"),c("a79d");var o=c("2b0e"),l=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",{attrs:{id:"app"}},[c("v-app",[c("div",{style:{display:t.loading?"flex":"none"},attrs:{id:"loading"}},[c("v-progress-circular",{attrs:{indeterminate:"",color:"black",size:70}})],1),c("v-container",{staticClass:"pl-1 pr-2 pt-0",attrs:{fluid:""}},[c("v-row",{attrs:{"no-gutters":""}},[c("Fillter",{attrs:{checkListProp:t.checkList},on:{searchEmit:t.search}})],1)],1)],1)],1)},s=[],a=(c("99af"),c("c975"),c("ac1f"),c("5319"),c("bc3a")),n=c.n(a),r=function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[c("div",{attrs:{id:"collapse-content"}},[c("v-row",{staticClass:"d-flex align-baseline",attrs:{"no-gutters":""}},[c("v-col",{attrs:{lg:"1",md:"1",sm:"3",cols:"12"}},[c("div",{staticClass:"d-flex justify-lg-end justify-md-end justify-sm-end justify-start fillterTitle"},[t._v(" 類別 ")])]),c("v-col",{staticClass:"ml-4",attrs:{lg:"10",md:"10",sm:"8",cols:"12"}},[c("v-row",{attrs:{"no-gutters":""}},[t.checkListProp&&0!=t.checkListProp.length?c("div",{staticClass:"mr-4"},[c("v-checkbox",{staticClass:"checkbox mt-0 mb-0",attrs:{label:"全部",color:"#007bff"},on:{click:t.selectAll},model:{value:t.checkboxAll,callback:function(e){t.checkboxAll=e},expression:"checkboxAll"}})],1):t._e(),t._l(t.checkListProp,(function(e,o){return c("div",{key:o,staticClass:"mr-4"},[c("v-checkbox",{staticClass:"checkbox mt-0",attrs:{label:e.title,value:e.no,color:"#007bff"},on:{click:t.checkAllSelect},model:{value:t.checkbox,callback:function(e){t.checkbox=e},expression:"checkbox"}})],1)}))],2)],1)],1),c("v-row",{staticClass:"d-flex align-baseline",attrs:{"no-gutters":""}},[c("v-col",{attrs:{lg:"1",md:"1",sm:"3",cols:"12"}},[c("div",{staticClass:"d-flex justify-lg-end justify-md-end justify-sm-end justify-start fillterTitle"},[t._v(" 學年期 ")])]),c("v-col",{staticClass:"mt-lg-0 mt-md-0 mt-sm-0 mt-3 ml-4",attrs:{lg:"9",md:"9",sm:"8",cols:"12"}},[c("v-row",{staticClass:"d-flex align-baseline mb-4",attrs:{"no-gutters":""}},[c("v-col",{staticClass:"d-flex justify-start",attrs:{lg:"2",md:"3",sm:"4",cols:"12"}},[c("v-text-field",{attrs:{outlined:"",dense:"","hide-details":"auto",rules:t.rules,placeholder:"開始學年期"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),c("v-col",{staticClass:"mt-lg-0 mb-lg-0 mt-md-0 mb-md-0 mt-1 mb-1",attrs:{lg:"1",md:"1",sm:"1",cols:"12"}},[t._v("至")]),c("v-col",{staticClass:"d-flex justify-start",attrs:{lg:"2",md:"3",sm:"4",cols:"12"}},[c("v-text-field",{attrs:{outlined:"",dense:"","hide-details":"auto",rules:t.rules,placeholder:"結束學年期"},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)],1)],1)],1),c("v-row",{staticClass:"d-flex align-baseline",attrs:{"no-gutters":""}},[c("v-col",{attrs:{lg:"1",md:"1",sm:"3",cols:"12"}},[c("div",{staticClass:"d-flex justify-lg-end justify-md-end justify-sm-end justify-start fillterTitle"},[t._v(" 次數 ")])]),c("v-col",{staticClass:"mt-lg-0 mt-md-0 mt-sm-0 mt-3 ml-4",attrs:{lg:"10",md:"10",sm:"8",cols:"12"}},[c("v-row",{staticClass:"d-flex align-baseline",attrs:{"no-gutters":""}},[c("v-col",{staticClass:"d-flex justify-start",attrs:{lg:"2",md:"3",sm:"4",cols:"12"}},[c("v-text-field",{attrs:{outlined:"",dense:"","hide-details":"auto",rules:t.numberRules},model:{value:t.count,callback:function(e){t.count=e},expression:"count"}})],1)],1)],1)],1),c("v-row",{staticClass:"no-gutters mt-3"},[c("v-col",{attrs:{lg:"1",md:"1",sm:"3",cols:"0"}}),c("v-col",{staticClass:"d-flex justify-start ml-4",attrs:{lg:"9",md:"9",sm:"8",cols:"12"}},[c("input",{staticClass:"btnSearch",staticStyle:{width:"200px"},attrs:{type:"button",value:"Excel下載"},on:{click:function(e){return t.search()}}})])],1)],1)])},i=[],u=(c("4160"),c("a15b"),c("159b"),{props:["checkListProp"],components:{},data:function(){return{collapse:!1,result:[],propValue:[],checkbox:[],checkboxAll:!1,count:0,propCount:0,pageCount:10,page:1,pageLen:0,startDate:"",endDate:"",rules:[function(t){return!!t||"必填"},function(t){return 4==(t||"").length||"必為4位數"},function(t){return!isNaN(t)||"必須為數字"}],numberRules:[function(t){return!isNaN(t)||"必須為數字"}]}},created:function(){},mounted:function(){},methods:{search:function(){var t=this;t.$emit("searchEmit",{checkList:t.checkbox,startDate:t.startDate,endDate:t.endDate,count:t.count})},selectAll:function(){var t=this;console.log(2),t.checkboxAll&&t.checkListProp&&0!=t.checkListProp.length?(console.log(3),t.checkbox=[],t.checkListProp.forEach((function(e){t.checkbox.push(e.no)})),console.log(4)):!t.checkboxAll&&t.checkListProp&&0!=t.checkListProp.length&&(t.checkbox=[])},checkAllSelect:function(){var t=this;t.checkListProp&&0!=t.checkListProp.length&&(t.checkbox.length==t.checkListProp.length?t.checkboxAll=!0:0==t.checkbox.length&&(t.checkboxAll=!1))},setDate:function(){Date.prototype.yyyymmdd=function(){var t=this.getMonth()+1,e=this.getDate();return[this.getFullYear(),"-",(t>9?"":"0")+t,"-",(e>9?"":"0")+e].join("")};var t=this,e=new Date,c=new Date,o=new Date;c=c.setDate(e.getDate()-30),o=o.setDate(e.getDate()+30),t.startDate=new Date(c).yyyymmdd(),t.endDate=new Date(o).yyyymmdd()},collapseSearch:function(){var t=this;t.collapse=!t.collapse,$("#collapse-content").slideToggle()}},watch:{checkListProp:function(){var t=this;t.checkboxAll=!0,t.checkbox=[],t.checkListProp.forEach((function(e){t.checkbox.push(e.no)}))}},computed:{searchCon:function(){var t=this,e=[];return t.checkListProp.forEach((function(c){t.checkbox.forEach((function(t){c.no==t&&e.push(c.title)}))})),e}}}),d=u,h=(c("9575"),c("2877")),f=c("6544"),p=c.n(f),g=c("ac7c"),m=c("62ad"),v=c("a523"),b=c("0fd9"),x=c("8654"),k=Object(h["a"])(d,r,i,!1,null,null,null),y=k.exports;p()(k,{VCheckbox:g["a"],VCol:m["a"],VContainer:v["a"],VRow:b["a"],VTextField:x["a"]});var C=c("debe"),w=c("80df"),_=c("25ca"),j=c("3e8f"),D=c("d485"),L=c("3f13");_["b"](j),_["c"].set_readable(D["Readable"]),_["a"](L);var P={name:"App",components:{Fillter:y},data:function(){return{testMode:!1,loading:!1,checkList:[],content:[],fileName:"",sheetName:""}},created:function(){var t=this;-1!=location.href.indexOf("localhost")||-1!=location.href.indexOf("git")?t.testMode=!0:t.testMode=!1,t.getCheckList()},updated:function(){var t=this;t.updateHeight()},methods:{axios:function(t,e,c,o,l){var s=this;s.loading=!0,n()({url:t+"?gGroups_i=".concat(gGroups,"&gSys_s=").concat(gSys_s,"&gFunc_s=").concat(gFunc_s),method:e,data:c,"Content-Type":"application/json"}).then((function(t){1==t.data.result?o(t.data.data):parent.sysDisplayMessage("",-1,"","",null,l+","+t.data.msg)})).catch((function(t){s.loading=!1,console.log(t),parent.sysDisplayMessage("",-1,"","",null,"連線失敗")}))},getCheckList:function(){var t=this;-1!=location.href.indexOf("localhost")||t.testMode?setTimeout((function(){t.setCheckList(C.data)}),1e3):t.axios("./kernel/warning_B.php","get",{},t.setCheckList,"抓取類別失敗")},setCheckList:function(t){var e=this;e.loading=!1,e.checkList=t},updateHeight:function(){var t=this;t.$nextTick((function(){setTimeout((function(){if(document.getElementById("app").scrollHeight>800){var t=document.body.scrollHeight+10;window.parent.postMessage('{"event": "changeHeight", "value": '+t+"}","*")}}),1e3)}))},search:function(t){var e=this;e.testMode?e.downloadFile({}):e.axios("./kernel/counseling_number_B.php","post",{type:t.checkList,year_semester_s:t.startDate,year_semester_e:t.endDate,number:t.count},e.downloadFile,"產生失敗")},downloadFile:function(t){var e=this;e.fileName="預警報告",e.sheetName="頁籤",-1!=location.href.indexOf("localhost")||e.testMode?e.exportExcel(w.data):e.exportExcel(t)},exportExcel:function(t){for(var e=this,c=_["d"].book_new(),o=0;o<t.sheet.length;o++){for(var l=[],s=t.sheet[o].col,a=[],n=1;n<=s;n++)a[n-1]=t.sheet[o].content[0]["col"+n];for(n=1;n<t.sheet[o].content.length;n++){for(var r={},i=1;i<=s;i++)r[a[i-1]]=t.sheet[o].content[n]["col"+i];l.push(r)}var u=_["d"].json_to_sheet(l,{header:a});_["d"].book_append_sheet(c,u,t.sheet[o].sheetName?0==t.sheet[o].sheetName.length?e.sheetName:t.sheet[o].sheetName.length>30?t.sheet[o].sheetName.substr(0,30).replace(/:/gi,"").replace(/\：/gi,"").replace(/\\/gi,"").replace(/\//gi,"").replace(/？/gi,"").replace(/\?/gi,"").replace(/＊/gi,"").replace(/\*/gi,""):t.sheet[o].sheetName.replace(/:/gi,"").replace(/\：/gi,"").replace(/\\/gi,"").replace(/\//gi,"").replace(/？/gi,"").replace(/\?/gi,"").replace(/＊/gi,"").replace(/\*/gi,""):e.sheetName)}_["e"](c,e.fileName+".xlsx"),e.loading=!1}}},A=P,N=(c("5c0b"),c("7496")),O=c("490a"),E=Object(h["a"])(A,l,s,!1,null,null,null),M=E.exports;p()(E,{VApp:N["a"],VContainer:v["a"],VProgressCircular:O["a"],VRow:b["a"]});var S=c("f309");o["a"].use(S["a"]);var T=new S["a"]({});o["a"].config.productionTip=!1,new o["a"]({vuetify:T,render:function(t){return t(M)}}).$mount("#app")},"5c0b":function(t,e,c){"use strict";c("9c0c")},"80df":function(t){t.exports=JSON.parse('{"result":1,"msg":"","data":{"sheet":[{"sheetName":"工作表1","content":[{"col1":"開始學年期","col2":"結束學年期","col3":"部別","col4":"院別","col5":"系所","col6":"組別","col7":"單位代碼","col8":"年級","col9":"班級","col10":"學號","col11":"姓名","col12":"預警類別","col13":"次數"},{"col1":"1001","col2":"1102","col3":"大學部","col4":"商學院","col5":"國際企業學系","col6":"不分組","col7":"B123456","col8":"4","col9":"A","col10":"B12345678","col11":"李大高","col12":"前六週未到課","col13":6},{"col1":"1001","col2":"1102","col3":"大學部","col4":"商學院","col5":"國際企業學系","col6":"不分組","col7":"A123456","col8":"4","col9":"A","col10":"A12345678","col11":"陳大高","col12":"前六週未到課","col13":6},{"col1":"1001","col2":"1102","col3":"大學部","col4":"商學院","col5":"國際企業學系","col6":"不分組","col7":"C123456","col8":"4","col9":"A","col10":"C12345678","col11":"張大高","col12":"前六週未到課","col13":6},{"col1":"1001","col2":"1102","col3":"大學部","col4":"商學院","col5":"國際企業學系","col6":"不分組","col7":"E123456","col8":"4","col9":"A","col10":"E12345678","col11":"陳大高","col12":"前六週未到課","col13":6},{"col1":"1001","col2":"1102","col3":"大學部","col4":"商學院","col5":"國際企業學系","col6":"不分組","col7":"T123456","col8":"4","col9":"A","col10":"T12345678","col11":"王大高","col12":"前六週未到課","col13":6}],"col":13}]}}')},9575:function(t,e,c){"use strict";c("5189")},"9c0c":function(t,e,c){},debe:function(t){t.exports=JSON.parse('{"result":"1","msg":"","data":[{"no":"100","title":"前學期2/3以上學分數不及格"},{"no":"200","title":"前六週未到課"},{"no":"300","title":"期中預警1/2以上學分數不及格"}]}')}});
//# sourceMappingURL=app.c3817dd8.js.map